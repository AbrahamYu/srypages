# 도커(Docker) 기본 개념과 사용법

> 본 포스팅은 [velog.io/@yerim7386/도커Docker](https://velog.io/@yerim7386/%EB%8F%84%EC%BB%A4Docker) 게시글을 참고하여 학습 및 정리한 내용입니다.

## 1. 도커(Docker)란?

![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)

도커는 애플리케이션을 신속하게 구축, 테스트 및 배포할 수 있는 컨테이너 기반의 오픈소스 가상화 플랫폼입니다. 각 애플리케이션은 **컨테이너**라는 격리된 환경에서 실행되며, 이는 기존의 가상 머신(VM) 방식보다 훨씬 가볍고 빠릅니다.

- **가상 머신(VM) vs 도커 컨테이너**
  - **VM**: 하드웨어 스택을 가상화하고, 각 VM마다 별도의 OS를 설치합니다. 이로 인해 용량이 크고, 실행 속도가 느리며, 라이선스 비용이 발생할 수 있습니다.
  - **도커 컨테이너**: 호스트 OS의 커널을 공유하며, 애플리케이션 실행에 필요한 라이브러리와 종속성만 포함합니다. 따라서 매우 가볍고, 빠르며, 효율적인 리소스 사용이 가능합니다.

## 2. 도커의 핵심 개념

### 1) 이미지 (Image)

**이미지**는 컨테이너를 생성하기 위한 **읽기 전용 템플릿**입니다. 애플리케이션과 그 실행에 필요한 모든 것(코드, 런타임, 라이브러리, 환경 변수 등)을 포함하고 있습니다.

- 이미지는 한 번 생성되면 변경할 수 없습니다(Immutable).
- 로컬에 저장된 이미지는 `docker image ls` 명령어로 확인할 수 있습니다.

### 2) 컨테이너 (Container)

**컨테이너**는 이미지의 **실행 가능한 인스턴스**입니다. 즉, 이미지를 기반으로 실제로 동작하는 격리된 프로세스입니다.

- 하나의 이미지로 여러 개의 컨테이너를 생성할 수 있습니다.
- 각 컨테이너는 독립적인 파일 시스템과 네트워크 공간을 가집니다.
- 현재 실행 중인 컨테이너는 `docker container ls` 또는 `docker ps` 명령어로 확인할 수 있습니다.

### 3) 레지스트리 (Registry)

**레지스트리**는 도커 이미지를 저장하고 공유하는 **저장소**입니다. 대표적인 레지스트리로는 **도커 허브(Docker Hub)**가 있습니다.

- 도커 허브에는 수많은 공식 이미지(예: `ubuntu`, `node`, `mysql`)가 있어 손쉽게 가져와 사용할 수 있습니다.
- `docker pull [이미지명]` 명령어로 이미지를 내려받을 수 있습니다.

## 3. 자주 사용하는 도커 명령어

다음은 도커를 사용할 때 자주 접하게 되는 기본 명령어들입니다.

### 이미지 관련 명령어

- **이미지 다운로드**
  ```bash
  docker pull [이미지명]:[태그]
  ```
- **이미지 목록 확인**
  ```bash
  docker images
  # 또는
  docker image ls
  ```
- **이미지 삭제**
  ```bash
  docker rmi [이미지 ID 또는 이름]
  ```

### 컨테이너 관련 명령어

- **컨테이너 생성 및 실행**
  ```bash
  # -d: 백그라운드 실행
  # -p [호스트 포트]:[컨테이너 포트]: 포트 포워딩
  # --name [이름]: 컨테이너 이름 지정
  docker run -d -p 8080:80 --name my-container [이미지명]
  ```
- **실행 중인 컨테이너 목록 확인**
  ```bash
  docker ps
  # 또는
  docker container ls
  ```
- **모든 컨테이너 목록 확인 (중지된 컨테이너 포함)**
  ```bash
  docker ps -a
  ```
- **컨테이너 중지/시작**
  ```bash
  docker stop [컨테이너 ID 또는 이름]
  docker start [컨테이너 ID 또는 이름]
  ```
- **컨테이너 삭제**
  ```bash
  docker rm [컨테이너 ID 또는 이름]
  ```
- **컨테이너 내부 접속**
  ```bash
  # -it: 상호작용 가능한 터미널 세션 열기
  docker exec -it [컨테이너 ID 또는 이름] /bin/bash
  ```

## 4. Dockerfile과 Docker Compose

### 1) Dockerfile

`Dockerfile`은 나만의 이미지를 만들기 위한 **설계도**입니다. 텍스트 파일에 이미지를 빌드하기 위한 명령어들을 순서대로 작성합니다.

- **간단한 `Dockerfile` 예시 (`Node.js` 애플리케이션)**
  ```dockerfile
  # 베이스 이미지 설정
  FROM node:18

  # 작업 디렉토리 설정
  WORKDIR /usr/src/app

  # package.json 및 package-lock.json 복사
  COPY package*.json ./

  # 종속성 설치
  RUN npm install

  # 소스 코드 복사
  COPY . .

  # 애플리케이션 실행 포트 노출
  EXPOSE 3000

  # 애플리케이션 실행 명령어
  CMD [ "node", "server.js" ]
  ```
- **이미지 빌드**
  ```bash
  # -t: 이미지 이름과 태그 지정
  docker build -t my-app:1.0 .
  ```

### 2) Docker Compose

`Docker Compose`는 여러 개의 컨테이너로 구성된 애플리케이션을 정의하고 실행하기 위한 도구입니다. `docker-compose.yml`이라는 YAML 파일을 사용하여 서비스를 설정합니다.

- **`docker-compose.yml` 예시**
  ```yaml
  version: '3.8'
  services:
    web:
      build: .
      ports:
        - "8000:8000"
    db:
      image: postgres:13
      environment:
        POSTGRES_DB: mydb
        POSTGRES_USER: user
        POSTGRES_PASSWORD: password
  ```
- **주요 명령어**
  - `docker-compose up`: 모든 서비스 시작 (백그라운드: `-d` 추가)
  - `docker-compose down`: 모든 서비스 중지 및 컨테이너 삭제
  - `docker-compose logs -f [서비스명]`: 특정 서비스의 로그 실시간 확인

## 결론

도커는 개발 환경을 통일하고, 배포를 자동화하며, 마이크로서비스 아키텍처를 구축하는 데 필수적인 도구로 자리 잡았습니다. 이 글에서 다룬 기본 개념과 명령어를 시작으로 도커의 강력한 기능들을 하나씩 익혀나가시길 바랍니다.
