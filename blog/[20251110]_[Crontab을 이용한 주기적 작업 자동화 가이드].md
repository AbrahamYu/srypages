# [linux] Crontab을 이용한 주기적 작업 자동화 완벽 가이드

## 소개
안녕하세요! 이번 포스트에서는 리눅스 및 유닉스 계열 시스템에서 주기적인 작업을 자동화하는 데 사용되는 강력한 도구, `crontab`에 대해 알아보겠습니다. 시스템 관리자나 개발자라면 누구나 반복적인 작업을 자동화하여 효율을 높이고 싶어 합니다. `crontab`은 바로 그럴 때 사용하는 최고의 친구입니다. 이 글을 통해 `crontab`의 기본 개념부터 고급 활용 팁까지 모든 것을 마스터해보세요.

## Crontab이란?
`crontab`은 "cron table"의 줄임말로, 특정 시간에 특정 명령어나 스크립트를 실행하도록 예약하는 데 사용되는 파일입니다. `cron`은 이러한 작업을 주기적으로 실행하는 데몬(백그라운드 프로세스)의 이름입니다. 즉, 우리는 `crontab` 파일에 원하는 작업 스케줄을 기록해두면, `cron` 데몬이 그 내용을 읽어 정해진 시간에 작업을 실행해주는 원리입니다.

주로 다음과 같은 작업에 활용됩니다.
- 주기적인 데이터 백업
- 로그 파일 정리
- 시스템 상태 모니터링 및 리포트 발송
- 특정 시간마다 데이터베이스 동기화

## Crontab 기본 사용법

### 1. Crontab 편집하기
`crontab`에 새로운 작업을 추가하거나 기존 작업을 수정하려면 아래 명령어를 사용합니다.
```bash
crontab -e
```
이 명령어를 처음 실행하면 `nano`, `vim` 등 어떤 편집기를 사용할지 물어볼 수 있습니다. 익숙한 편집기를 선택하여 작업을 진행하세요.

### 2. Crontab 내용 조회하기
현재 설정된 `crontab` 작업 목록을 확인하려면 다음 명령어를 사용합니다.
```bash
crontab -l
```

### 3. Crontab 내용 삭제하기
모든 `crontab` 작업을 삭제하려면 아래 명령어를 사용하세요. **주의: 이 명령어는 확인 절차 없이 모든 작업을 삭제하므로 신중하게 사용해야 합니다.**
```bash
crontab -r
```

## Crontab 스케줄링 문법
`crontab`의 핵심은 바로 이 스케줄링 문법입니다. 하나의 작업 라인은 총 6개의 필드로 구성되며, 마지막 필드에 실행할 명령어를 작성합니다.

```
* * * * * /path/to/command
- - - - -
| | | | |
| | | | +----- 요일 (0 - 7) (일요일=0 또는 7)
| | | +------- 월 (1 - 12)
| | | --------- 일 (1 - 31)
| | ----------- 시 (0 - 23)
| ------------- 분 (0 - 59)
```

각 필드에는 다음과 같은 값을 사용할 수 있습니다.
- `*`: 모든 값을 의미합니다. (예: 분 필드에 `*`가 있으면 '매 분마다')
- `숫자`: 특정 값을 의미합니다. (예: 시 필드에 `10`이 있으면 '오전 10시에')
- `,`: 여러 값을 나열합니다. (예: 분 필드에 `0,15,30,45`가 있으면 '0분, 15분, 30분, 45분에')
- `-`: 값의 범위를 지정합니다. (예: 시 필드에 `9-17`이 있으면 '오전 9시부터 오후 5시까지 매 시간')
- `/`: 특정 주기를 설정합니다. (예: 분 필드에 `*/10`이 있으면 '10분마다')

## Crontab 예제

#### 1. 매일 자정에 스크립트 실행
```bash
0 0 * * * /home/user/backup.sh
```
- 매일 0시 0분에 `/home/user/backup.sh` 스크립트를 실행합니다.

#### 2. 10분마다 특정 명령어 실행
```bash
*/10 * * * * /usr/bin/python3 /home/user/check_status.py
```
- 10분마다 파이썬 스크립트를 실행합니다.

#### 3. 매주 월요일 오전 9시 30분에 실행
```bash
30 9 * * 1 /home/user/weekly_report.sh
```
- 요일 필드에 `1`을 사용하여 월요일을 지정했습니다.

#### 4. 매달 1일 새벽 3시에 실행
```bash
0 3 1 * * /home/user/monthly_cleanup.sh
```
- 일 필드에 `1`을 사용하여 매달 1일을 지정했습니다.

## 고급 팁 및 주의사항

### 1. 실행 결과(Output) 리다이렉션
`cron` 작업은 터미널 없이 백그라운드에서 실행되므로, 실행 결과나 오류를 확인하기 어렵습니다. 따라서 출력 결과를 파일로 저장하는 것이 좋습니다.

- **표준 출력과 표준 오류를 모두 파일에 기록:**
  ```bash
  * * * * * /path/to/command > /var/log/myjob.log 2>&1
  ```
- **출력을 무시하고 싶을 때 (블랙홀로 보내기):**
  ```bash
  * * * * * /path/to/command > /dev/null 2>&1
  ```

### 2. 절대 경로 사용
`cron` 작업은 사용자의 셸 환경(`~/.bashrc`, `~/.zshrc` 등)을 로드하지 않을 수 있습니다. 따라서 명령어와 스크립트 경로는 항상 **절대 경로**로 지정하는 것이 안전합니다. `which` 명령어를 사용하면 명령어의 절대 경로를 쉽게 찾을 수 있습니다.
```bash
which python3
# /usr/bin/python3
```

### 3. 스크립트 실행 권한
실행하려는 스크립트 파일(`.sh`, `.py` 등)에 실행 권한이 부여되어 있는지 확인하세요.
```bash
chmod +x /path/to/your/script.sh
```

## 결론
`crontab`은 단순하지만 매우 강력한 시스템 자동화 도구입니다. 처음에는 문법이 낯설 수 있지만, 몇 가지 예제를 따라 해보면 금방 익숙해질 수 있습니다. 반복적인 수동 작업을 `crontab`으로 자동화하여 소중한 시간을 아끼고 시스템 관리의 효율성을 한 단계 높여보세요.
